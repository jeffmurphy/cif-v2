package CIF::Smrt::Plugin::Postprocessor::Malware;
use base 'CIF::Smrt::Plugin::Postprocessor';

use strict;
use warnings;

use Iodef::Pb::Simple qw(iodef_malware);

use Module::Pluggable require => 1, search_path => [__PACKAGE__];

my @plugins = __PACKAGE__->plugins();

sub process {
    my $class   = shift;
    my $smrt    = shift;
    my $data    = shift;
 
    my $malware = iodef_malware($data);
    return unless($malware);
        
    my $array;
    foreach (@plugins){
        my $r = $_->process($smrt,$data);
        push(@$array,@$r) if($r && @$r);
    }
    return $array;
}

1;